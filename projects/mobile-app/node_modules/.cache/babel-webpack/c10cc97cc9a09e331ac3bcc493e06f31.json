{"ast":null,"code":"import _asyncToGenerator from \"/Users/avsv/Documents/GitHub/atlas-workspace/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../api/api-user.service\";\nimport * as i2 from \"./token.service\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"../platform/fcm.service\";\nexport class UserService {\n  constructor(apiUserService, tokenService, navCtrl, fcmService) {\n    this.apiUserService = apiUserService;\n    this.tokenService = tokenService;\n    this.navCtrl = navCtrl;\n    this.fcmService = fcmService;\n  }\n\n  authorize() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const token = yield _this.tokenService.loadToken();\n      return !!token;\n    })();\n  }\n\n  login(code) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const user = yield _this2.apiUserService.authorize(code);\n      yield _this2.tokenService.saveToken(user.token);\n      yield _this2.navCtrl.navigateRoot('start');\n\n      _this2.fcmService.sendFcmToken().then();\n    })();\n  }\n\n  logout() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this3.tokenService.deleteToken();\n      yield _this3.navCtrl.navigateRoot('auth');\n    })();\n  }\n\n}\n\nUserService.ɵfac = function UserService_Factory(t) {\n  return new (t || UserService)(i0.ɵɵinject(i1.ApiUserService), i0.ɵɵinject(i2.TokenService), i0.ɵɵinject(i3.NavController), i0.ɵɵinject(i4.FcmService));\n};\n\nUserService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: UserService,\n  factory: UserService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/Users/avsv/Documents/GitHub/atlas-workspace/projects/mobile-app/src/app/core/services/data/user.service.ts"],"names":["i0","i1","i2","i3","i4","UserService","constructor","apiUserService","tokenService","navCtrl","fcmService","authorize","token","loadToken","login","code","user","saveToken","navigateRoot","sendFcmToken","then","logout","deleteToken","ɵfac","UserService_Factory","t","ɵɵinject","ApiUserService","TokenService","NavController","FcmService","ɵprov","ɵɵdefineInjectable","factory","providedIn"],"mappings":";AAAA,OAAO,KAAKA,EAAZ,MAAoB,eAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,yBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,iBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,gBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,yBAApB;AACA,OAAO,MAAMC,WAAN,CAAkB;AACrBC,EAAAA,WAAW,CAACC,cAAD,EAAiBC,YAAjB,EAA+BC,OAA/B,EAAwCC,UAAxC,EAAoD;AAC3D,SAAKH,cAAL,GAAsBA,cAAtB;AACA,SAAKC,YAAL,GAAoBA,YAApB;AACA,SAAKC,OAAL,GAAeA,OAAf;AACA,SAAKC,UAAL,GAAkBA,UAAlB;AACH;;AACKC,EAAAA,SAAS,GAAG;AAAA;;AAAA;AACd,YAAMC,KAAK,SAAS,KAAI,CAACJ,YAAL,CAAkBK,SAAlB,EAApB;AACA,aAAO,CAAC,CAACD,KAAT;AAFc;AAGjB;;AACKE,EAAAA,KAAK,CAACC,IAAD,EAAO;AAAA;;AAAA;AACd,YAAMC,IAAI,SAAS,MAAI,CAACT,cAAL,CAAoBI,SAApB,CAA8BI,IAA9B,CAAnB;AACA,YAAM,MAAI,CAACP,YAAL,CAAkBS,SAAlB,CAA4BD,IAAI,CAACJ,KAAjC,CAAN;AACA,YAAM,MAAI,CAACH,OAAL,CAAaS,YAAb,CAA0B,OAA1B,CAAN;;AACA,MAAA,MAAI,CAACR,UAAL,CAAgBS,YAAhB,GAA+BC,IAA/B;AAJc;AAKjB;;AACKC,EAAAA,MAAM,GAAG;AAAA;;AAAA;AACX,YAAM,MAAI,CAACb,YAAL,CAAkBc,WAAlB,EAAN;AACA,YAAM,MAAI,CAACb,OAAL,CAAaS,YAAb,CAA0B,MAA1B,CAAN;AAFW;AAGd;;AApBoB;;AAsBzBb,WAAW,CAACkB,IAAZ,GAAmB,SAASC,mBAAT,CAA6BC,CAA7B,EAAgC;AAAE,SAAO,KAAKA,CAAC,IAAIpB,WAAV,EAAuBL,EAAE,CAAC0B,QAAH,CAAYzB,EAAE,CAAC0B,cAAf,CAAvB,EAAuD3B,EAAE,CAAC0B,QAAH,CAAYxB,EAAE,CAAC0B,YAAf,CAAvD,EAAqF5B,EAAE,CAAC0B,QAAH,CAAYvB,EAAE,CAAC0B,aAAf,CAArF,EAAoH7B,EAAE,CAAC0B,QAAH,CAAYtB,EAAE,CAAC0B,UAAf,CAApH,CAAP;AAAyJ,CAA9M;;AACAzB,WAAW,CAAC0B,KAAZ,GAAoB,aAAc/B,EAAE,CAACgC,kBAAH,CAAsB;AAAEpB,EAAAA,KAAK,EAAEP,WAAT;AAAsB4B,EAAAA,OAAO,EAAE5B,WAAW,CAACkB,IAA3C;AAAiDW,EAAAA,UAAU,EAAE;AAA7D,CAAtB,CAAlC","sourcesContent":["import * as i0 from \"@angular/core\";\nimport * as i1 from \"../api/api-user.service\";\nimport * as i2 from \"./token.service\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"../platform/fcm.service\";\nexport class UserService {\n    constructor(apiUserService, tokenService, navCtrl, fcmService) {\n        this.apiUserService = apiUserService;\n        this.tokenService = tokenService;\n        this.navCtrl = navCtrl;\n        this.fcmService = fcmService;\n    }\n    async authorize() {\n        const token = await this.tokenService.loadToken();\n        return !!token;\n    }\n    async login(code) {\n        const user = await this.apiUserService.authorize(code);\n        await this.tokenService.saveToken(user.token);\n        await this.navCtrl.navigateRoot('start');\n        this.fcmService.sendFcmToken().then();\n    }\n    async logout() {\n        await this.tokenService.deleteToken();\n        await this.navCtrl.navigateRoot('auth');\n    }\n}\nUserService.ɵfac = function UserService_Factory(t) { return new (t || UserService)(i0.ɵɵinject(i1.ApiUserService), i0.ɵɵinject(i2.TokenService), i0.ɵɵinject(i3.NavController), i0.ɵɵinject(i4.FcmService)); };\nUserService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: UserService, factory: UserService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}